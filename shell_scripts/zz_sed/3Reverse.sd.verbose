#! /bin/sed -f

# Ignore Empty Lines.
/./!b


s/!/!!/g
p
s/^/-!-/p
s/$/-!-/p

ta
:a
s/-!-\([^!]\|!!\)\(.*\)\([^!]\|!!\)-!-/\3-!-\2-!-\1/p
ta

s/-!-//g
s/!!/!/g
